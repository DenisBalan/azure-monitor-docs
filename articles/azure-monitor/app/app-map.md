---
title: Application map in Azure Application Insights
description: Monitor complex application topologies with Application map and Intelligent view by using Application Insights in Azure Monitor.
ms.topic: concept-article
ms.date: 05/21/2024
ms.devlang: csharp
# ms.devlang: csharp, java, javascript, python
ms.custom: devx-track-csharp
ms.reviewer: rijolly

#customer intent: As a developer, I want use the Application map and Intelligent view features in Azure Monitor so that I can monitor complex application topologies.
---

# Application map: Triage distributed applications

Developers use application maps to represent the logical structure of their distributed applications. A map is produced by identifying the individual application components with their `roleName` or `name` property in recorded telemetry. Circles (or _nodes_) on the map represent the components and directional lines (_connectors_ or _edges_) show the HTTP calls from _source_ nodes to _target_ nodes.

Azure Monitor provides the **Application map** feature to help you quickly implement a map and spot performance bottlenecks or failure hotspots across all components. Each map node is an application component or its dependencies, and provides health KPI and alerts status. You can select any node to see detailed diagnostics for the component, such as Application Insights events. If your app uses Azure services, you can also select Azure diagnostics, such as SQL Database Advisor recommendations.

**Application map** also features [Intelligent view](#application-map-intelligent-view) to assist with fast service health investigations.

## Understand components

Components are independently deployable parts of your distributed or microservice application. Developers and operations teams have code-level visibility or access to telemetry generated by these application components. 

Some considerations about components:

- Components are different from "observed" external dependencies, such as Azure SQL and Azure Event Hubs, which your team or organization might not have access to (code or telemetry).
- Components run on any number of server, role, or container instances.
- Components can be separate Application Insights resources, even if subscriptions are different. They can also be different roles that report to a single Application Insights resource. The preview map experience shows the components regardless of how they're set up.

## Explore Application map

**Application map** lets you see the full application topology across multiple levels of related application components. As described earlier, components can be different Application Insights resources, dependent components, or different roles in a single resource. **Application map** locates components by following HTTP dependency calls made between servers with the Application Insights SDK installed.

The mapping experience starts with the progressive discovery of the components within the application and their dependencies. When you first load **Application map**, a query set triggers to discover the components related to the main component. As components are discovered, a status bar shows the current number of discovered components:

:::image type="content" source="media/app-map/load-initial.png" alt-text="Screenshot that shows the initial load of an application map in the Azure portal." border="false" lightbox="media/app-map/load-initial-large.png":::

The following sections describe some of the actions available for working with **Application map** in the Azure portal.

### Update map components

The **Update map components** option triggers discovery of components and refreshes the map to show all current nodes. Depending on the complexity of your application, the update can take a minute to load:

:::image type="content" source="media/app-map/update-components.png" alt-text="Screenshot that shows how to update the current components in an application map." lightbox="media/app-map/update-components-large.png" :::

When all application components are roles within a single Application Insights resource, the discovery step isn't required. The initial load in this application scenario discovers all of the components.

### View component details

A key objective for the **Application map** experience is to help you visualize complex topologies that have hundreds of components. In this scenario, it's useful to enhance the map view with details for an individual node by using the **View details** option. The node details pane shows related insights, performance, and failure triage experience for the selected component:

:::image type="content" source="media/app-map/view-details.png" alt-text="Screenshot that shows how to view details for a selected node in an application map." lightbox="media/app-map/view-details-large.png":::

Each pane section includes an option to see more information in an expanded view, including failures, performance, and details about failed requests and dependencies.

### Investigate failures

In the node details pane, you can use the **Investigate failures** option to view all failures for the component:

:::image type="content" source="media/app-map/investigate-failures.png" alt-text="Screenshot that shows how to select the Investigate failures option in the node details pane." border="false" lightbox="media/app-map/investigate-failures-large.png":::

The **Failures** view lets you explore failure data for operations, dependencies, exceptions, and roles related to the selected component:

:::image type="content" source="media/app-map/view-failures.png" alt-text="Screenshot that shows the Failures view for a selected component." lightbox="media/app-map/view-failures-large.png":::

### Investigate performance

In the node details pane, you can troubleshoot performance problems with the component by selecting the **Investigate performance** option:

:::image type="content" source="media/app-map/investigate-performance.png" alt-text="Screenshot that shows how to select the Investigate performance option in the node details pane." border="false" lightbox="media/app-map/investigate-performance-large.png":::

The **Performance** view lets you explore telemetry data for operations, dependencies, and roles connected with the selected component:

:::image type="content" source="media/app-map/view-performance.png" alt-text="Screenshot that shows the Performance view for a selected component." lightbox="media/app-map/view-performance-large.png":::

### Go to details and stack trace

The **Go to details** option in the node details pane displays the end-to-end transaction experience for the component. This pane lets you view details at the call stack level:

:::image type="content" source="media/app-map/go-to-details.png" alt-text="Screenshot that shows how to select the Go to details option in the node details pane." border="false" lightbox="media/app-map/go-to-details-large.png":::

The page opens to show the **Timeline** view for the details:

:::image type="content" source="media/app-map/view-end-to-end-transaction.png" alt-text="Screenshot that shows the Details view for a selected component." lightbox="media/app-map/view-end-to-end-transaction-large.png":::

You can use the **View all** option to see the stack details with trace and event information for the component:

:::image type="content" source="media/app-map/view-traces-events.png" alt-text="Screenshot that shows the All traces and events view for a selected component." lightbox="media/app-map/view-traces-events-large.png":::

### View in Logs (Analytics)

In the node details pane, you can query and investigate your applications data further with the **View in Logs (Analytics)** option: 

:::image type="content" source="media/app-map/view-in-logs.png" alt-text="Screenshot that shows how to select the View in Logs (Analytics) option in the node details pane." lightbox="media/app-map/view-in-logs-large.png":::

The **Logs (Analytics)** page provides options to explore your application telemetry table records with built-in or custom queries and functions. You can work with the data by adjusting the format, and saving and exporting your analysis: 

:::image type="content" source="media/app-map/query-log-analytics.png" alt-text="Screenshot that shows the Logs screen with a line graph that summarizes the average response duration of a request over the past 12 hours." lightbox="media/app-map/query-log-analytics-large.png":::

### View alerts and rules

The **View alerts** option in the node details pane lets you see active alerts:

:::image type="content" source="media/app-map/view-alerts.png" alt-text="Screenshot that shows how to select the View Alerts option in the node details pane." lightbox="media/app-map/view-alerts-large.png":::

The **Alerts** page shows critical and fired alerts:

:::image type="content" source="media/app-map/review-alerts.png" alt-text="Screenshot that shows the list of alerts for the selected component." lightbox="media/app-map/review-alerts-large.png":::

The **Alert rules** option on the **Alerts** page shows the underlying rules that cause the alerts to trigger:

:::image type="content" source="media/app-map/review-alert-rules.png" alt-text="Screenshot that shows the list of alert rules defined for the selected component." lightbox="media/app-map/review-alert-rules-large.png":::

## Understand cloud role names and nodes

**Application map** uses the cloud role name property to identify the application components on a map. To explore how cloud role names are used with component nodes, look at an application map that has multiple cloud role names present. 

The following example shows a map in **Hierarchical view** with five component nodes and connectors to nine dependent nodes. Each node has a cloud role name.

:::image type="content" source="media/app-map/review-cloud-role-names.png" alt-text="Screenshot that shows an application map with several nodes and different color highlights." lightbox="media/app-map/review-cloud-role-names-large.png":::

**Application map** uses different colors, highlights, and sizes for nodes to depict the application component data and relationships:

- The cloud role names express the different aspects of the distributed application. In this example, some of the application roles include `Contoso Retail Check`, `Fabrikam-App`, `fabrikam-loadfunc`, `retailfabrikam-37ha6`, and `retailapp`.

- The dotted blue circle around a node indicates the last selected component. In this example, the last selected component is the `Web` node.

- When you select a node to see the details, a solid blue circle highlights the node. In the example, the currently selected node is `Contoso Retail Reports`.

- Distant or unrelated component nodes are shown smaller in comparison to the other nodes. These items are dimmed in the view to highlight performance for the currently selected component.

- In this example, each cloud role name also represents a different unique Application Insights resource with its own instrumentation keys. Because the owner of this application has access to each of those four disparate Application Insights resources, **Application map** can stitch together a map of the underlying relationships.

### Investigate cloud role instances

When a cloud role name reveals a problem somewhere in your web frontend, and you're running multiple load-balanced servers across your web frontend, using a _cloud role instance_ can be helpful. **Application map** lets you view deeper information about a component node by using Kusto queries. You can investigate a node to view details about specific cloud role instances. This approach helps you determine whether an issue affects all web front-end servers or only specific instances.

A scenario where you might want to override the value for a cloud role instance is when your app is running in a containerized environment. In this case, information about the individual server might not be sufficient to locate the specific issue.

For more information about how to override the cloud role name property with telemetry initializers, see [Add properties: ITelemetryInitializer](api-filtering-sampling.md#addmodify-properties-itelemetryinitializer).

## Set or override cloud role names

**Application map** uses the cloud role name property to identify the components on the map. This section provides examples to manually set or override cloud role names and change what appears on the application map. 

> [!NOTE]
> The Application Insights SDK or Agent automatically adds the cloud role name property to the telemetry emitted by components in an Azure App Service environment.

The following snippet shows the schema definitions for the cloud role and cloud role instance:

```dotnetcli
[Description("Name of the role the application is a part of. Maps directly to the role name in Azure.")]
[MaxStringLength("256")]
705: string      CloudRole = "ai.cloud.role";

[Description("Name of the instance where the application is running. Computer name for on-premises, instance name for Azure.")]
[MaxStringLength("256")]
715: string      CloudRoleInstance = "ai.cloud.roleInstance";
```

For the [official definitions](https://github.com/Microsoft/ApplicationInsights-dotnet/blob/39a5ef23d834777eefdd72149de705a016eb06b0/Schema/PublicSchema/ContextTagKeys.bond#L93):

# [.NET/.NetCore](#tab/net)

**Write custom TelemetryInitializer**

```csharp
using Microsoft.ApplicationInsights.Channel;
using Microsoft.ApplicationInsights.Extensibility;

namespace CustomInitializer.Telemetry
{
    public class MyTelemetryInitializer : ITelemetryInitializer
    {
        public void Initialize(ITelemetry telemetry)
        {
            if (string.IsNullOrEmpty(telemetry.Context.Cloud.RoleName))
            {
                //set custom role name here
                telemetry.Context.Cloud.RoleName = "Custom RoleName";
                telemetry.Context.Cloud.RoleInstance = "Custom RoleInstance";
            }
        }
    }
}
```

**ASP.NET apps: Load initializer in the active TelemetryConfiguration**

In the _ApplicationInsights.config_ file:

```xml
    <ApplicationInsights>
      <TelemetryInitializers>
        <!-- Fully qualified type name, assembly name: -->
        <Add Type="CustomInitializer.Telemetry.MyTelemetryInitializer, CustomInitializer"/>
        ...
      </TelemetryInitializers>
    </ApplicationInsights>
```

An alternate method for ASP.NET Web apps is to instantiate the initializer in code. The following example shows code in the _Global.aspx.cs_ file:

```csharp
 using Microsoft.ApplicationInsights.Extensibility;
 using CustomInitializer.Telemetry;

    protected void Application_Start()
    {
        // ...
        TelemetryConfiguration.Active.TelemetryInitializers.Add(new MyTelemetryInitializer());
    }
```

> [!NOTE]
> Adding an initializer by using the `ApplicationInsights.config` or `TelemetryConfiguration.Active` property isn't valid for ASP.NET Core applications.

**ASP.NET Core apps: Load an initializer to TelemetryConfiguration**

For [ASP.NET Core](asp-net-core.md#add-telemetryinitializers) applications, to add a new `TelemetryInitializer` instance, you add it to the Dependency Injection container. The following example shows this approach. Add this code in the `ConfigureServices` method of your `Startup.cs` class.

```csharp
 using Microsoft.ApplicationInsights.Extensibility;
 using CustomInitializer.Telemetry;
 public void ConfigureServices(IServiceCollection services)
{
    services.AddSingleton<ITelemetryInitializer, MyTelemetryInitializer>();
}
```

# [Java](#tab/java)

**Set cloud role name**

```json
{
  "role": {
    "name": "my cloud role name"
  }
}
```

You can also set the cloud role name with an environment variable or system property. For more information, see [Configuring cloud role name](./java-standalone-config.md#cloud-role-name).

# [Node.js](#tab/nodejs)

**Set cloud role name**

```javascript
var appInsights = require("applicationinsights");
appInsights.setup('INSTRUMENTATION_KEY').start();
appInsights.defaultClient.context.tags["ai.cloud.role"] = "your role name";
appInsights.defaultClient.context.tags["ai.cloud.roleInstance"] = "your role instance";
```

***Node.js: Set cloud role name**

```javascript
var appInsights = require("applicationinsights");
appInsights.setup('INSTRUMENTATION_KEY').start();

appInsights.defaultClient.addTelemetryProcessor(envelope => {
    envelope.tags["ai.cloud.role"] = "your role name";
    envelope.tags["ai.cloud.roleInstance"] = "your role instance"
});
```

# [JavaScript](#tab/javascript)

**Set cloud role name**

```javascript
appInsights.queue.push(() => {
appInsights.addTelemetryInitializer((envelope) => {
  envelope.tags["ai.cloud.role"] = "your role name";
  envelope.tags["ai.cloud.roleInstance"] = "your role instance";
});
});
```

# [Python](#tab/python)

**Set cloud role name**

For Python, you can use [OpenCensus Python telemetry processors](api-filtering-sampling.md#opencensus-python-telemetry-processors).

```python
def callback_function(envelope):
   envelope.tags['ai.cloud.role'] = 'new_role_name'

# AzureLogHandler
handler.add_telemetry_processor(callback_function)

# AzureExporter
exporter.add_telemetry_processor(callback_function)
```
---

## Use Application map filters

**Application map** filters help you reduce the number of visible nodes and edges on your map. These filters can be used to reduce the scope of the map and show a smaller and more focused view.

To create a filter, select **Add filter**:

:::image type="content" source="media/app-map/image-1.png" alt-text="Screenshot that shows how to select the Add Filter option in Application map." lightbox="media/app-map/image-1.png":::

The **Add filter** pane has three sections: **Select filter type**, **Choose filter parameters**, and **Review**:

:::image type="content" source="media/app-map/image-2.png" alt-text="Screenshot that shows the Node Filter radio button selected." lightbox="media/app-map/image-2.png":::

:::image type="content" source="media/app-map/image-3.png" alt-text="Screenshot that shows the Connector Edge Filter radio button selected." lightbox="media/app-map/image-3.png":::

The first section has two options, _node filter_ and _connector (edge) filter_. The contents in the other sections change based on the option selected.

### Set node filters

Node filters allow the user to leave only selected nodes on the map and hide the rest. A node filter checks each node if it contains a property (its name, for example) with a value that matches a search value through a given operator. If a node is removed by a node filter, all of its connectors (edges) are also removed.

There are three parameters available for nodes:

- **Nodes included** allows the user to select only nodes with matching properties or to also include source nodes, target nodes, or both in the resulting map.

   - "Nodes and sources, targets": Nodes that match the search parameters are included in the resulting map. Nodes that are sources or targets for the match node are also included, even if they don't have property values that match the search. Source and target nodes are collectively referred to as "Connected" nodes.

   - "Nodes and sources": Same behavior as "Nodes and sources, targets," but target nodes aren't automatically included in the results.

   - "Nodes and targets": Same behavior as "Nodes and sources," but source nodes aren't automatically included.

   - "Nodes only": All nodes in the resulting map must have a property value that matches.

- **Operator** is the type of check that will be performed on each node's property values:

   - `contains`
   - `!contains` (not contains)
   - `== (equals)`
   - `!=` (not equals)

- **Search value** is the text that has to be contained, not contained, equal, or not equal to a node property value. Some of the values found in nodes that are on the map are shown in a drop-down. Any arbitrary value can be entered by clicking "Create option ..." in the drop-down.

For example, in the screenshot below, the filter is being configured to select **Node(s)** that **contain(s)** the text **"-west".** **Source** and t**arget** nodes will also be included in the resulting map. In the same screenshot, the user is able to select one of the values found in the map or to create an option that isn't an exact match to one found in the map.

:::image type="content" source="media/app-map/image-4.png" alt-text="Screenshot that shows the filter configured to select nodes that contain the text west.":::

### Set connector (edge) filters

Connector filters examine the properties of a connector to match a value. Connectors that don't match the filter are removed from the map. The same happens to nodes with no connectors left.

Connector filters require three parameters:

- **Filter connectors by** allows the user to choose which property of a connector to use:

   - **Error connector (highlighted red)** selects connectors based on their color (red or not). A value can't be entered for this type of filter, only an operator that is "==" or "!=" meaning "connector with errors" and "connector without errors."

   - **Error rate** uses the average error rate for the connector (number of failed calls divided by number of all calls) expressed as a percentage. For example, a value of "1" would refer to 1% failed calls.

   - **Average call duration (****ms)** uses just that: the average duration of all calls represented by the connector, in milliseconds. For example, a value of "1000" would refer to calls that averaged 1 second.

   - **Calls count** uses the total number of calls represented by the connector.

- **Operator** is the comparison that applied between the connector property and the value entered below. The options change: "Error connector" has equals/not equals options; all others have greater/less than.

- **Value** is the comparison value for the filter. There's only one option for the "Error connector" filter: "Errors." Other filter types require a numeric value and offer a drop-down with some prepopulated entries relevant to the map.

   - Some of these entries have a designation "(Pxx)" which are percentile levels. For example, "Average call duration" filter might have the value "200 (P90)" which indicates 90% of all connectors (regardless of the number of calls they represent) have less than 200-ms call duration.

   - When a specific number isn't shown in the drop-down, it can be typed, and created by clicking on "Create option." Typing "P" shows all the percentile values in the drop-down.

### Review your filters

The Review section contains textual and visual descriptions about the filter that can help you learn how filters work:

:::image type="content" source="media/app-map/image-5.png" alt-text="Screenshot that shows the Review section with node in focus." lightbox="media/app-map/image-5.png":::

:::image type="content" source="media/app-map/image-6.png" alt-text="Screenshot that shows the Review section depicting an average call duration greater than 42 milliseconds." lightbox="media/app-map/image-6.png":::

### Apply filters to map

After you configure a filter in the **Add filter** pane, select **Apply** to create the filter. Several filters can be applied, and they work sequentially, from left to right. Each filter can remove further nodes and connectors, but can't add them back to the map.

Your filters display as rounded buttons above the application map:

:::image type="content" source="media/app-map/apply-filters.png" alt-text="Screenshot that shows the rounded filter buttons above the application map." lightbox="media/app-map/apply-filters-large.png":::

Select the :::image type="icon" source="media/app-map/remove-filter.png"::: action on a filter to remove the filter from the map view. If you select the filter name, you can edit the filter's values. As you change values in the filter, the new values are applied to a preview of the map so you can inspect the change. Select **Cancel** to restore the previous filter values.

:::image type="content" source="media/app-map/image-9.png" alt-text="Screenshot that shows the Configure Connector Filter section with a Cancel button." lightbox="media/app-map/image-9.png":::

Filters can be reused in two ways:

- The "Copy link" button on the toolbar above the map encodes the filter information in the copied URL. This link can be saved in the browser's bookmarks or shared with others. "Copy link" preserves the duration value, but not the absolute time, so the map shown at a later time might be different from the one observed when the link was created.

- The dashboard pin :::image type="icon" source="media/app-map/pin-to-dashboard.png"::: is located next to the title bar of the **Application map** pane. This button pins the map to a dashboard, along with the filters applied to it. This action can be useful for filters that are frequently interesting. As an example, the user can pin a map with "Error connector" filter applied to it, and the dashboard view shows only nodes that have errors in their HTTP calls.

There are many filter combinations. Here are some suggestions that apply to most maps and can be useful to pin on a dashboard:

- Show only errors that appear significant by using the "Error connector" filter along with "Intelligent view":
    
   :::image type="content" source="media/app-map/image-11.png" alt-text="Screenshot that shows the Last 24 hours and Highlighted Errors filters." lightbox="media/app-map/image-11.png":::
    
   :::image type="content" source="media/app-map/image-12.png" alt-text="Screenshot that shows the Intelligent Overview toggle." lightbox="media/app-map/image-12.png":::

- Hide low-traffic connectors with no errors to quickly focus on issues that have higher impact:

   :::image type="content" source="media/app-map/image-13.png" alt-text="Screenshot that shows the Last 24 hours, calls greater than 876, and highlighted errors filters." lightbox="media/app-map/image-13.png":::
    
- Show high-traffic connectors with high average duration to focus on potential performance issues:

   :::image type="content" source="media/app-map/image-14.png" alt-text="Screenshot that shows the Last 24 hours, calls greater than 3057, and average time greater than 467 filters." lightbox="media/app-map/image-14.png":::
    
- Show a specific portion of a distributed application (requires suitable roleName naming convention):

   :::image type="content" source="media/app-map/image-15.png" alt-text="Screenshot that shows the Last 24 hours and Connected Contains West filters." lightbox="media/app-map/image-15.png":::

- Hide a dependency type that is too noisy:

   :::image type="content" source="media/app-map/image-16.png" alt-text="Screenshot that shows the Last 24 hours and Nodes Contains Storage Accounts filters." lightbox="media/app-map/image-16.png":::

- Show only connectors that have higher error rates than a specific value

   :::image type="content" source="media/app-map/image-17.png" alt-text="Screenshot that shows the Last 24 hours and Errors greater than 0.01 filters." lightbox="media/app-map/image-17.png :::  


## Intelligent view

The **Intelligent view** feature for **Application map** is designed to aid in service health investigations. It applies machine learning to quickly identify potential root causes of issues by filtering out noise. The machine learning model learns from **Application map**'s historical behavior to identify dominant patterns and anomalies that indicate potential causes of an incident.

In large distributed applications, there's always some degree of noise coming from "benign" failures, which might cause **Application map** to be noisy by showing many red edges. **Intelligent view** shows only the most probable causes of service failure and removes node-to-node red edges (service-to-service communication) in healthy services. **Intelligent view** highlights the edges in red that should be investigated. It also offers actionable insights for the highlighted edge.

There are many benefits to using **Intelligent view**:

- Reduces time to resolution by highlighting only failures that need to be investigated
- Provides actionable insights on why a certain red edge was highlighted
- Enables **Application map** to be used for large distributed applications seamlessly (by focusing only on  edges marked in red)

### Intelligent view in Application map

Enable the **Intelligent view** toggle. Optionally, to change the sensitivity of the detections, select **Low**, **Medium**, or **High**. For more information, see the troubleshooting question about [sensitivity](#how-does-intelligent-view-sensitivity-work).

:::image type="content" source="media/app-map/intelligent-view-toggle.png" alt-text="Screenshot that shows the Application map user interface with options to toggle Intelligent view and provide feedback." lightbox="media/app-map/intelligent-view-toggle.png":::

After you enable **Intelligent view**, select one of the highlighted edges to see the "actionable insights." The insights appear in the pane on the right and explain why the edge was highlighted.

:::image type="content" source="media/app-map/intelligent-view-highlight-explanation.png" alt-text="Screenshot that shows the Application map user interface section about actionable insights." lightbox="media/app-map/intelligent-view-highlight-explanation.png":::

To begin troubleshooting, select **Investigate failures**. In the **Failures** pane that opens, investigate if the detected issue is the root cause. If no edges are red, the machine learning model didn't find potential incidents in the dependencies of your application.

To provide feedback, select the **Feedback** button on the map.

### Determination of highlighted red edges

**Intelligent view** uses the patented AIOps machine learning model to highlight the significant and important data in an application map. These edges in your map are highlighted in red. Various application data are used to determine which data to highlight on the map, including:

- Failure rates
- Request counts
- Durations
- Anomalies in the data
- Types of dependency

For comparison, the normal view only utilizes the raw failure rate.

### Sensitivity setting

**Intelligent view** sensitivity adjusts the probability that a service issue is detected.

Adjust sensitivity to achieve the desired confidence level in highlighted edges.

| Sensitivity | Description |
| --- | --- |
| **High**    | Fewer edges are highlighted. |
| **Medium**  | (Default setting) A balanced number of edges are highlighted. |
| **Low**     | More edges are highlighted. |

### View limitations

**Intelligent view** has some limitations:

- Large distributed applications might take a minute to load **Intelligent view**.
- Time frames of up to seven days are supported.

## Troubleshooting tips

If you're having trouble getting **Application map** to work as expected, review the suggestions in the following sections.

Here are some general recommendations:

- Make sure to use an officially supported SDK. Unsupported or community SDKs might not support correlation. For a list of supported SDKs, see [Application Insights: Languages, platforms, and integrations](./app-insights-overview.md#supported-languages).

- Upgrade all components to the latest SDK version.

- If you use Azure Functions with C#, upgrade to [Azure Functions V2](../../azure-functions/functions-versions.md).

- Confirm the [cloud role name](#set-or-override-cloud-role-name) is correctly configured.

- If a dependency is missing, make sure it's in the list of [autocollected dependencies](asp-net-dependencies.md#dependency-auto-collection). If the dependency isn't listed, you can track it manually with a [track dependency call](./api-custom-events-metrics.md#trackdependency).

### Too many nodes on map

**Application map** constructs an application node for each unique cloud role name present in your request telemetry. A dependency node is also constructed for each unique combination of type, target, and cloud role name.

If there are more than 10,000 nodes in your telemetry, **Application map** can't fetch all the nodes and links. In this scenario, your map structure is incomplete. If this scenario occurs, a warning message appears when you view the map.

**Application map** can render a maximum of 1,000 separate ungrouped nodes at once. **Application map** reduces visual complexity by grouping dependencies together when they have the same type and callers.

If your telemetry has too many unique cloud role names or too many dependency types, the grouping is insufficient and the map isn't rendered.

To fix this issue, you need to change your instrumentation to properly set the cloud role name, dependency type, and dependency target fields. Confirm your application adheres to the following criteria: 

- A dependency target should represent the logical name of a dependency. In many cases, it's equivalent to the server or resource name of the dependency. For example, if there are HTTP dependencies, it's set to the hostname. It shouldn't contain unique IDs or parameters that change from one request to another.

- A dependency type should represent the logical type of a dependency. For example, HTTP, SQL, or Azure Blob are typical dependency types. It shouldn't contain unique IDs.

- A cloud role name purpose should apply the description in the [Set or override cloud role name](#set-or-override-cloud-role-name) section.

### Intelligent view: Edge not highlighted

You might notice an edge in your map that isn't highlighted as expected, even with a low sensitivity setting. In this case, a dependency might appear to be failing but the model doesn't indicate it's a potential incident. Here are some possible scenarios:

* If this dependency has been failing for a while, the model might believe it's a regular state, and not highlight the edge for you. It focuses on problem-solving in RT.
* If this dependency has a minimal effect on the overall performance of the app that can also make the model ignore it.
* If none of the above is correct, use the **Feedback** option and describe your experience. You can help us improve future model versions.

### Intelligent view: Edge highlighted

If an edge is highlighted, the explanation from the model should point you to the most important features that made the model give this dependency a high probability score. The recommendation isn't based solely on failures but on other indicators like unexpected latency in dominant flows.

### Intelligent view: Doesn't load

If **Intelligent view** doesn't load, set the configured time frame to six days or less.

### Intelligent view: Long load time

If **Intelligent view** takes longer to load than expected, avoid selecting the **Update map components** option. Enable **Intelligent view** only for a single Application Insights resource.

## Related content

- To learn more about how correlation works in Application Insights, see [Telemetry correlation](distributed-trace-data.md).

- The [end-to-end transaction diagnostic experience](./transaction-search-and-diagnostics.md?tabs=transaction-diagnostics) correlates server-side telemetry from across all your Application Insights-monitored components into a single view.

- For advanced correlation scenarios in ASP.NET Core and ASP.NET, see [Track custom operations](custom-operations-tracking.md).
